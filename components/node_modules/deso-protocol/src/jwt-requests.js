import { api, cleanURL, media, } from './data/index.js';
import { TransactionExtraDataKV, TransactionMetadataUpdateGlobalParams, encodeUTF8ToBytes, identity, uvarint64ToBuf, } from './identity/index.js';
import { constructBalanceModelTx, handleSignAndSubmit } from './internal.js';
const jwtPost = async (endpoint, params = {}, options) => {
    const isAdminRequest = endpoint.includes('api/v0/admin');
    let AdminPublicKey = '';
    if (isAdminRequest) {
        const { currentUser } = await identity.snapshot();
        if (!currentUser) {
            throw new Error('Cannot issue an admin request without a logged in user');
        }
        AdminPublicKey = currentUser.publicKey;
    }
    const postParams = {
        ...params,
        ...(isAdminRequest && { AdminPublicKey }),
        JWT: params.JWT ?? (await identity.jwt()),
    };
    if (options?.broadcast) {
        return handleSignAndSubmit(endpoint, postParams, options);
    }
    return api.post(options?.nodeURI ? cleanURL(options.nodeURI, endpoint) : endpoint, postParams);
};
/**
 * https://docs.deso.org/deso-backend/api/user-endpoints#get-user-global-metadata-email-and-phone-number
 */
export const getUserGlobalMetadata = async (params, options) => {
    return jwtPost('api/v0/get-user-global-metadata', params, options);
};
export const updateUserGlobalMetadata = async (params, options) => {
    return jwtPost('api/v0/update-user-global-metadata', params, options);
};
/**
 * https://docs.deso.org/deso-backend/api/user-endpoints#delete-pii-personal-identifiable-information
 */
export const deletePII = async (params, options) => {
    return jwtPost('api/v0/delete-pii', params, options);
};
export const blockPublicKey = async (params, options) => {
    return jwtPost('api/v0/block-public-key', params, options);
};
/**
 * https://docs.deso.org/deso-backend/api/notification-endpoints#set-notification-metadata
 */
export const setNotificationMetadata = async (params, options) => {
    return jwtPost('api/v0/set-notification-metadata', params, options);
};
///////////////////////////////////////////////////////////////////////////////
// Admin endpoints
///////////////////////////////////////////////////////////////////////////////
/**
 * https://docs.deso.org/deso-backend/api/admin-endpoints#get-verified-users
 */
export const adminGetVerifiedUsers = (options) => {
    return jwtPost('api/v0/admin/get-verified-users', {}, options);
};
/**
 * https://docs.deso.org/deso-backend/api/admin-endpoints#get-username-verification-audit-logs
 */
export const adminGetUsernameVerificationAuditLog = (params, options) => {
    return jwtPost('api/v0/admin/get-username-verification-audit-log', params, options);
};
export const adminNodeControl = (params, options) => {
    return jwtPost('api/v0/admin/node-control', params, options);
};
export const adminGrantVerificationBadge = (params, options) => {
    return jwtPost('api/v0/admin/grant-verification-badge', params, options);
};
export const adminRemoveVerificationBadge = (params, options) => {
    return jwtPost('api/v0/admin/remove-verification-badge', params, options);
};
export const adminGetUserAdminData = (params, options) => {
    return jwtPost('api/v0/admin/get-user-admin-data', params, options);
};
export const adminGetUserGlobalMetadata = (params, options) => {
    return jwtPost('api/v0/admin/get-user-global-metadata', params, options);
};
export const adminUpdateUserGlobalMetadata = (params, options) => {
    return jwtPost('api/v0/admin/update-user-global-metadata', params, options);
};
export const adminGetAllUserGlobalMetadata = (params, options) => {
    return jwtPost('api/v0/admin/get-all-user-global-metadata', params, options);
};
export const adminPinPost = (params, options) => {
    return jwtPost('api/v0/admin/pin-post', params, options);
};
export const adminUpdateGlobalFeed = (params, options) => {
    return jwtPost('api/v0/admin/update-global-feed', params, options);
};
export const adminRemoveNilPosts = (params, options) => {
    return jwtPost('api/v0/admin/remove-nil-posts', params, options);
};
export const adminReprocessBitcoinBlock = (blockHashOrBlockHeight, options) => {
    return jwtPost(`api/v0/admin/reprocess-bitcoin-block/${blockHashOrBlockHeight}`, {}, options);
};
export const adminGetMempoolStats = (options) => {
    return jwtPost('api/v0/admin/get-mempool-stats', {}, options);
};
export const adminSwapIdentity = async (params, options) => {
    return jwtPost('api/v0/admin/swap-identity', params, options);
};
export const adminSetUSDCentsToDESOReserveExchangeRate = (params, options) => {
    return jwtPost('api/v0/admin/set-usd-cents-to-deso-reserve-exchange-rate', params, options);
};
// Not a jwt request, but it's an admin endpoint so it's here...
export const adminGetUSDCentsToDESOReserveExchangeRate = (options) => {
    const endpoint = 'api/v0/admin/get-usd-cents-to-deso-reserve-exchange-rate';
    return api.get(options?.nodeURI ? cleanURL(options.nodeURI, endpoint) : endpoint);
};
export const adminSetBuyDesoFeeBasisPoints = (params, options) => {
    return jwtPost('api/v0/admin/set-buy-deso-fee-basis-points', params, options);
};
export const adminGetBuyDesoFeeBasisPoints = (options) => {
    const endpoint = 'api/v0/admin/get-buy-deso-fee-basis-points';
    return api.get(options?.nodeURI ? cleanURL(options.nodeURI, endpoint) : endpoint);
};
export const adminUpdateGlobalParams = async (params, options) => {
    return handleSignAndSubmit('api/v0/admin/update-global-params', params, {
        ...options,
        constructionFunction: constructAdminUpdateGlobalParamsTransaction,
    });
};
export const constructAdminUpdateGlobalParamsTransaction = async (params) => {
    const metadata = new TransactionMetadataUpdateGlobalParams();
    const consensusExtraDataKVs = [];
    if (params.USDCentsPerBitcoin >= 0) {
        consensusExtraDataKVs.push(new TransactionExtraDataKV(encodeUTF8ToBytes('USDCentsPerBitcoin'), uvarint64ToBuf(params.USDCentsPerBitcoin)));
    }
    if (params.MinimumNetworkFeeNanosPerKB >= 0) {
        consensusExtraDataKVs.push(new TransactionExtraDataKV(encodeUTF8ToBytes('MinNetworkFeeNanosPerKB'), uvarint64ToBuf(params.MinimumNetworkFeeNanosPerKB)));
    }
    if (params.CreateProfileFeeNanos >= 0) {
        consensusExtraDataKVs.push(new TransactionExtraDataKV(encodeUTF8ToBytes('CreateProfileFeeNanos'), uvarint64ToBuf(params.CreateProfileFeeNanos)));
    }
    if (params.CreateNFTFeeNanos >= 0) {
        consensusExtraDataKVs.push(new TransactionExtraDataKV(encodeUTF8ToBytes('CreateNFTFeeNanos'), uvarint64ToBuf(params.CreateNFTFeeNanos)));
    }
    if (params.MaxCopiesPerNFT >= 0) {
        consensusExtraDataKVs.push(new TransactionExtraDataKV(encodeUTF8ToBytes('MaxCopiesPerNFT'), uvarint64ToBuf(params.MaxCopiesPerNFT)));
    }
    return constructBalanceModelTx(params.UpdaterPublicKeyBase58Check, metadata, {
        ExtraData: params.ExtraData,
        MinFeeRateNanosPerKB: params.MinFeeRateNanosPerKB,
        TransactionFees: params.TransactionFees,
        ConsensusExtraDataKVs: consensusExtraDataKVs,
    });
};
export const adminGetGlobalParams = (options) => {
    return jwtPost('api/v0/admin/get-global-params', {}, options);
};
export const adminGetNFTDrop = (params, options) => {
    return jwtPost('api/v0/admin/get-nft-drop', params, options);
};
export const adminUpdateNFTDrop = (params, options) => {
    return jwtPost('/api/v0/admin/update-nft-drop', params, options);
};
export const adminGetUnfilteredHotFeed = (params, options) => {
    return jwtPost('api/v0/admin/get-unfiltered-hot-feed', params, options);
};
export const adminGetHotFeedAlgorithm = (options) => {
    return jwtPost('api/v0/admin/get-hot-feed-algorithm', {}, options);
};
export const adminUpdateHotFeedAlgorithm = (params, options) => {
    return jwtPost('api/v0/admin/update-hot-feed-algorithm', params, options);
};
export const adminUpdateHotFeedUserMultiplier = (params, options) => {
    return jwtPost('api/v0/admin/update-hot-feed-user-multiplier', params, options);
};
export const adminUpdateHotFeedPostMultiplier = (params, options) => {
    return jwtPost('api/v0/admin/update-hot-feed-post-multiplier', params, options);
};
export const adminGetHotFeedUserMultiplier = (params, options) => {
    return jwtPost('api/v0/admin/get-hot-feed-user-multiplier', params, options);
};
export const adminGetWyreWalletOrdersForUser = (params, options) => {
    return jwtPost('api/v0/admin/get-wyre-wallet-orders-for-public-key', params, options);
};
export const adminGetWyreWalletOrderQuotation = (params, options) => {
    return jwtPost('api/v0/admin/get-wyre-wallet-order-quotation', params, options);
};
export const adminGetWyreWalletOrderReservation = (params, options) => {
    return jwtPost('api/v0/admin/get-wyre-wallet-order-reservation', params, options);
};
export const resendVerifyEmail = (params, options) => {
    return jwtPost('api/v0/resend-verify-email', params, options);
};
export const verifyEmail = (params, options) => {
    const endpoint = 'api/v0/verify-email';
    return api.post(options?.nodeURI ? cleanURL(options.nodeURI, endpoint) : endpoint, params);
};
export const uploadImage = async (params, options) => {
    const JWT = params.JWT ?? (await identity.jwt());
    const endpoint = 'api/v0/upload-image';
    return api.post(options?.nodeURI ? cleanURL(options.nodeURI, endpoint) : endpoint, { JWT, ...params }, { contentType: 'multipart/form-data' });
};
export const uploadVideo = async (params) => {
    const JWT = params.JWT ?? (await identity.jwt());
    const endpoint = 'api/v0/upload-video';
    return media.post(endpoint, { JWT, ...params }, { contentType: 'multipart/form-data' });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiand0LXJlcXVlc3RzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2p3dC1yZXF1ZXN0cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFrRUEsT0FBTyxFQUVMLEdBQUcsRUFDSCxRQUFRLEVBQ1IsS0FBSyxHQUNOLE1BQU0saUJBQWlCLENBQUM7QUFDekIsT0FBTyxFQUNMLHNCQUFzQixFQUN0QixxQ0FBcUMsRUFDckMsaUJBQWlCLEVBQ2pCLFFBQVEsRUFDUixjQUFjLEdBQ2YsTUFBTSxxQkFBcUIsQ0FBQztBQUM3QixPQUFPLEVBQUUsdUJBQXVCLEVBQUUsbUJBQW1CLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFN0UsTUFBTSxPQUFPLEdBQUcsS0FBSyxFQUNuQixRQUFnQixFQUNoQixTQUFjLEVBQUUsRUFDaEIsT0FBd0IsRUFDeEIsRUFBRTtJQUNGLE1BQU0sY0FBYyxHQUFHLFFBQVEsQ0FBQyxRQUFRLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDekQsSUFBSSxjQUFjLEdBQUcsRUFBRSxDQUFDO0lBRXhCLElBQUksY0FBYyxFQUFFO1FBQ2xCLE1BQU0sRUFBRSxXQUFXLEVBQUUsR0FBRyxNQUFNLFFBQVEsQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUVsRCxJQUFJLENBQUMsV0FBVyxFQUFFO1lBQ2hCLE1BQU0sSUFBSSxLQUFLLENBQUMsd0RBQXdELENBQUMsQ0FBQztTQUMzRTtRQUVELGNBQWMsR0FBRyxXQUFXLENBQUMsU0FBUyxDQUFDO0tBQ3hDO0lBRUQsTUFBTSxVQUFVLEdBQUc7UUFDakIsR0FBRyxNQUFNO1FBQ1QsR0FBRyxDQUFDLGNBQWMsSUFBSSxFQUFFLGNBQWMsRUFBRSxDQUFDO1FBQ3pDLEdBQUcsRUFBRSxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUM7S0FDMUMsQ0FBQztJQUVGLElBQUksT0FBTyxFQUFFLFNBQVMsRUFBRTtRQUN0QixPQUFPLG1CQUFtQixD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QUFPLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQ2pFLE1BQU0sQ0FDUCxDQUFDO0FBQ0osQ0FBQyxDQUFDO0FBRUYsTUFBTSxDQUFDLE1BQU0sV0FBVyxHQUFHLEtBQUssRUFDOUIsTUFHQyxFQUNELE9BQXdCLEVBQ00sRUFBRTtJQUNoQyxNQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNqRCxNQUFNLFFBQVEsR0FBRyxxQkFBcUIsQ0FBQztJQUV2QyxPQUFPLEdBQUcsQ0FBQyxJQUFJLENBQ2IsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFDakUsRUFBRSxHQUFHLEVBQUUsR0FBRyxNQUFNLEVBQUUsRUFDbEIsRUFBRSxXQUFXLEVBQUUscUJBQXFCLEVBQUUsQ0FDdkMsQ0FBQztBQUNKLENBQUMsQ0FBQztBQUVGLE1BQU0sQ0FBQyxNQUFNLFdBQVcsR0FBRyxLQUFLLEVBQzlCLE1BR0MsRUFDK0IsRUFBRTtJQUNsQyxNQUFNLEdBQUcsR0FBRyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsTUFBTSxRQUFRLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztJQUNqRCxNQUFNLFFBQVEsR0FBRyxxQkFBcUIsQ0FBQztJQUN2QyxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQ2YsUUFBUSxFQUNSLEVBQUUsR0FBRyxFQUFFLEdBQUcsTUFBTSxFQUFFLEVBQ2xCLEVBQUUsV0FBVyxFQUFFLHFCQUFxQixFQUFFLENBQ3ZDLENBQUM7QUFDSixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZG1pbkdldEFsbFVzZXJHbG9iYWxNZXRhZGF0YVJlcXVlc3QsXG4gIEFkbWluR2V0SG90RmVlZEFsZ29yaXRobVJlc3BvbnNlLFxuICBBZG1pbkdldEhvdEZlZWRVc2VyTXVsdGlwbGllclJlcXVlc3QsXG4gIEFkbWluR2V0SG90RmVlZFVzZXJNdWx0aXBsaWVyUmVzcG9uc2UsXG4gIEFkbWluR2V0TWVtcG9vbFN0YXRzUmVzcG9uc2UsXG4gIEFkbWluR2V0TkZURHJvcFJlcXVlc3QsXG4gIEFkbWluR2V0TkZURHJvcFJlc3BvbnNlLFxuICBBZG1pbkdldFVzZXJBZG1pbkRhdGFSZXF1ZXN0LFxuICBBZG1pbkdldFVzZXJBZG1pbkRhdGFSZXNwb25zZSxcbiAgQWRtaW5HZXRVc2VyR2xvYmFsTWV0YWRhdGFSZXF1ZXN0LFxuICBBZG1pbkdldFVzZXJHbG9iYWxNZXRhZGF0YVJlc3BvbnNlLFxuICBBZG1pbkdldFVzZXJuYW1lVmVyaWZpY2F0aW9uQXVkaXRMb2dzUmVxdWVzdCxcbiAgQWRtaW5HZXRVc2VybmFtZVZlcmlmaWNhdGlvbkF1ZGl0TG9nc1Jlc3BvbnNlLFxuICBBZG1pbkdldFZlcmlmaWVkVXNlcnNSZXNwb25zZSxcbiAgQWRtaW5HcmFudFZlcmlmaWNhdGlvbkJhZGdlUmVxdWVzdCxcbiAgQWRtaW5HcmFudFZlcmlmaWNhdGlvbkJhZGdlUmVzcG9uc2UsXG4gIEFkbWluUGluUG9zdFJlcXVlc3QsXG4gIEFkbWluUmVtb3ZlTmlsUG9zdHNSZXF1ZXN0LFxuICBBZG1pblJlbW92ZVZlcmlmaWNhdGlvbkJhZGdlUmVxdWVzdCxcbiAgQWRtaW5SZW1vdmVWZXJpZmljYXRpb25CYWRnZVJlc3BvbnNlLFxuICBBZG1pblVwZGF0ZUdsb2JhbEZlZWRSZXF1ZXN0LFxuICBBZG1pblVwZGF0ZUhvdEZlZWRBbGdvcml0aG1SZXF1ZXN0LFxuICBBZG1pblVwZGF0ZUhvdEZlZWRQb3N0TXVsdGlwbGllclJlcXVlc3QsXG4gIEFkbWluVXBkYXRlSG90RmVlZFVzZXJNdWx0aXBsaWVyUmVxdWVzdCxcbiAgQWRtaW5VcGRhdGVORlREcm9wUmVxdWVzdCxcbiAgQWRtaW5VcGRhdGVORlREcm9wUmVzcG9uc2UsXG4gIEFkbWluVXBkYXRlVXNlckdsb2JhbE1ldGFkYXRhUmVxdWVzdCxcbiAgQmxvY2tQdWJsaWNLZXlSZXF1ZXN0LFxuICBCbG9ja1B1YmxpY0tleVJlc3BvbnNlLFxuICBDb25zdHJ1Y3RlZFRyYW5zYWN0aW9uUmVzcG9uc2UsXG4gIERlbGV0ZVBJSVJlcXVlc3QsXG4gIEdldEJ1eURlU29GZWVCYXNpc1BvaW50c1Jlc3BvbnNlLFxuICBHZXRHbG9iYWxQYXJhbXNSZXNwb25zZSxcbiAgR2V0VVNEQ2VudHNUb0RlU29FeGNoYW5nZVJhdGVSZXNwb25zZSxcbiAgR2V0VXNlckdsb2JhbE1ldGFkYXRhUmVxdWVzdCxcbiAgR2V0VXNlckdsb2JhbE1ldGFkYXRhUmVzcG9uc2UsXG4gIEdldFd5cmVXYWxsZXRPcmRlckZvclB1YmxpY0tleVJlcXVlc3QsXG4gIEdldFd5cmVXYWxsZXRPcmRlckZvclB1YmxpY0tleVJlc3BvbnNlLFxuICBIb3RGZWVkUGFnZVJlcXVlc3QsXG4gIEhvdEZlZWRQYWdlUmVzcG9uc2UsXG4gIE5vZGVDb250cm9sUmVxdWVzdCxcbiAgTm9kZUNvbnRyb2xSZXNwb25zZSxcbiAgUmVxdWVzdE9wdGlvbnMsXG4gIFJlc2VuZFZlcmlmeUVtYWlsUmVxdWVzdCxcbiAgU2V0QnV5RGVTb0ZlZUJhc2lzUG9pbnRzUmVxdWVzdCxcbiAgU2V0QnV5RGVTb0ZlZUJhc2lzUG9pbnRzUmVzcG9uc2UsXG4gIFNldE5vdGlmaWNhdGlvbk1ldGFkYXRhUmVxdWVzdCxcbiAgU2V0VVNEQ2VudHNUb0RlU29FeGNoYW5nZVJhdGVSZXF1ZXN0LFxuICBTZXRVU0RDZW50c1RvRGVTb0V4Y2hhbmdlUmF0ZVJlc3BvbnNlLFxuICBTd2FwSWRlbnRpdHlSZXF1ZXN0LFxuICBTd2FwSWRlbnRpdHlSZXNwb25zZSxcbiAgVHhSZXF1ZXN0V2l0aE9wdGlvbmFsRmVlc0FuZEV4dHJhRGF0YSxcbiAgVXBkYXRlR2xvYmFsUGFyYW1zUmVxdWVzdCxcbiAgVXBkYXRlR2xvYmFsUGFyYW1zUmVzcG9uc2UsXG4gIFVwZGF0ZVVzZXJHbG9iYWxNZXRhZGF0YVJlcXVlc3QsXG4gIFVwbG9hZEltYWdlUmVxdWVzdCxcbiAgVXBsb2FkSW1hZ2VSZXNwb25zZSxcbiAgVXBsb2FkVmlkZW9SZXF1ZXN0LFxuICBVcGxvYWRWaWRlb1YyUmVzcG9uc2UsXG4gIFZlcmlmeUVtYWlsUmVxdWVzdCxcbiAgV2FsbGV0T3JkZXJRdW90YXRpb25SZXF1ZXN0LFxuICBXYWxsZXRPcmRlclJlc2VydmF0aW9uUmVxdWVzdCxcbiAgV3lyZVdhbGxldE9yZGVyUXVvdGF0aW9uUGF5bG9hZCxcbiAgV3lyZVdhbGxldE9yZGVyUmVzZXJ2YXRpb25QYXlsb2FkLFxufSBmcm9tICcuL2JhY2tlbmQtdHlwZXMvaW5kZXguanMnO1xuaW1wb3J0IHtcbiAgUGFydGlhbFdpdGhSZXF1aXJlZEZpZWxkcyxcbiAgYXBpLFxuICBjbGVhblVSTCxcbiAgbWVkaWEsXG59IGZyb20gJy4vZGF0YS9pbmRleC5qcyc7XG5pbXBvcnQge1xuICBUcmFuc2FjdGlvbkV4dHJhRGF0YUtWLFxuICBUcmFuc2FjdGlvbk1ldGFkYXRhVXBkYXRlR2xvYmFsUGFyYW1zLFxuICBlbmNvZGVVVEY4VG9CeXRlcyxcbiAgaWRlbnRpdHksXG4gIHV2YXJpbnQ2NFRvQnVmLFxufSBmcm9tICcuL2lkZW50aXR5L2luZGV4LmpzJztcbmltcG9ydCB7IGNvbnN0cnVjdEJhbGFuY2VNb2RlbFR4LCBoYW5kbGVTaWduQW5kU3VibWl0IH0gZnJvbSAnLi9pbnRlcm5hbC5qcyc7XG5pbXBvcnQgeyBDb25zdHJ1Y3RlZEFuZFN1Ym1pdHRlZFR4IH0gZnJvbSAnLi90eXBlcy5qcyc7XG5jb25zdCBqd3RQb3N0ID0gYXN5bmMgKFxuICBlbmRwb2ludDogc3RyaW5nLFxuICBwYXJhbXM6IGFueSA9IHt9LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbikgPT4ge1xuICBjb25zdCBpc0FkbWluUmVxdWVzdCA9IGVuZHBvaW50LmluY2x1ZGVzKCdhcGkvdjAvYWRtaW4nKTtcbiAgbGV0IEFkbWluUHVibGljS2V5ID0gJyc7XG5cbiAgaWYgKGlzQWRtaW5SZXF1ZXN0KSB7XG4gICAgY29uc3QgeyBjdXJyZW50VXNlciB9ID0gYXdhaXQgaWRlbnRpdHkuc25hcHNob3QoKTtcblxuICAgIGlmICghY3VycmVudFVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGlzc3VlIGFuIGFkbWluIHJlcXVlc3Qgd2l0aG91dCBhIGxvZ2dlZCBpbiB1c2VyJyk7XG4gICAgfVxuXG4gICAgQWRtaW5QdWJsaWNLZXkgPSBjdXJyZW50VXNlci5wdWJsaWNLZXk7XG4gIH1cblxuICBjb25zdCBwb3N0UGFyYW1zID0ge1xuICAgIC4uLnBhcmFtcyxcbiAgICAuLi4oaXNBZG1pblJlcXVlc3QgJiYgeyBBZG1pblB1YmxpY0tleSB9KSxcbiAgICBKV1Q6IHBhcmFtcy5KV1QgPz8gKGF3YWl0IGlkZW50aXR5Lmp3dCgpKSxcbiAgfTtcblxuICBpZiAob3B0aW9ucz8uYnJvYWRjYXN0KSB7XG4gICAgcmV0dXJuIGhhbmRsZVNpZ25BbmRTdWJtaXQoZW5kcG9pbnQsIHBvc3RQYXJhbXMsIG9wdGlvbnMpO1xuICB9XG5cbiAgcmV0dXJuIGFwaS5wb3N0KFxuICAgIG9wdGlvbnM/Lm5vZGVVUkkgPyBjbGVhblVSTChvcHRpb25zLm5vZGVVUkksIGVuZHBvaW50KSA6IGVuZHBvaW50LFxuICAgIHBvc3RQYXJhbXNcbiAgKTtcbn07XG5cbi8qKlxuICogaHR0cHM6Ly9kb2NzLmRlc28ub3JnL2Rlc28tYmFja2VuZC9hcGkvdXNlci1lbmRwb2ludHMjZ2V0LXVzZXItZ2xvYmFsLW1ldGFkYXRhLWVtYWlsLWFuZC1waG9uZS1udW1iZXJcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFVzZXJHbG9iYWxNZXRhZGF0YSA9IGFzeW5jIChcbiAgcGFyYW1zOiBQYXJ0aWFsV2l0aFJlcXVpcmVkRmllbGRzPFxuICAgIEdldFVzZXJHbG9iYWxNZXRhZGF0YVJlcXVlc3QsXG4gICAgJ1VzZXJQdWJsaWNLZXlCYXNlNThDaGVjaydcbiAgPixcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEdldFVzZXJHbG9iYWxNZXRhZGF0YVJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvZ2V0LXVzZXItZ2xvYmFsLW1ldGFkYXRhJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbi8qKlxuICogaHR0cHM6Ly9kb2NzLmRlc28ub3JnL2Rlc28tYmFja2VuZC9hcGkvdXNlci1lbmRwb2ludHMjdXBkYXRlLXVzZXItZ2xvYmFsLW1ldGFkYXRhLWVtYWlsLWFuZC1zdGF0ZS1vZi1tZXNzYWdlcy1yZWFkXG4gKi9cbmV4cG9ydCB0eXBlIFVwZGF0ZVVzZXJHbG9iYWxNZXRhZGF0YVBhcmFtcyA9IFBhcnRpYWxXaXRoUmVxdWlyZWRGaWVsZHM8XG4gIFVwZGF0ZVVzZXJHbG9iYWxNZXRhZGF0YVJlcXVlc3QsXG4gICdVc2VyUHVibGljS2V5QmFzZTU4Q2hlY2snXG4+O1xuZXhwb3J0IGNvbnN0IHVwZGF0ZVVzZXJHbG9iYWxNZXRhZGF0YSA9IGFzeW5jIChcbiAgcGFyYW1zOiBVcGRhdGVVc2VyR2xvYmFsTWV0YWRhdGFQYXJhbXMsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKSA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvdXBkYXRlLXVzZXItZ2xvYmFsLW1ldGFkYXRhJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbi8qKlxuICogaHR0cHM6Ly9kb2NzLmRlc28ub3JnL2Rlc28tYmFja2VuZC9hcGkvdXNlci1lbmRwb2ludHMjZGVsZXRlLXBpaS1wZXJzb25hbC1pZGVudGlmaWFibGUtaW5mb3JtYXRpb25cbiAqL1xuZXhwb3J0IGNvbnN0IGRlbGV0ZVBJSSA9IGFzeW5jIChcbiAgcGFyYW1zOiBQYXJ0aWFsV2l0aFJlcXVpcmVkRmllbGRzPERlbGV0ZVBJSVJlcXVlc3QsICdQdWJsaWNLZXlCYXNlNThDaGVjayc+LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8dW5kZWZpbmVkPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvZGVsZXRlLXBpaScsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG4vKipcbiAqIGh0dHBzOi8vZG9jcy5kZXNvLm9yZy9kZXNvLWJhY2tlbmQvYXBpL3VzZXItZW5kcG9pbnRzI2Jsb2NrLXB1YmxpYy1rZXlcbiAqL1xuZXhwb3J0IHR5cGUgQmxvY2tQdWJsaWNLZXlQYXJhbXMgPSBQYXJ0aWFsV2l0aFJlcXVpcmVkRmllbGRzPFxuICBCbG9ja1B1YmxpY0tleVJlcXVlc3QsXG4gICdCbG9ja1B1YmxpY0tleUJhc2U1OENoZWNrJyB8ICdQdWJsaWNLZXlCYXNlNThDaGVjaydcbj47XG5leHBvcnQgY29uc3QgYmxvY2tQdWJsaWNLZXkgPSBhc3luYyAoXG4gIHBhcmFtczogQmxvY2tQdWJsaWNLZXlQYXJhbXMsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxCbG9ja1B1YmxpY0tleVJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYmxvY2stcHVibGljLWtleScsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG4vKipcbiAqIGh0dHBzOi8vZG9jcy5kZXNvLm9yZy9kZXNvLWJhY2tlbmQvYXBpL25vdGlmaWNhdGlvbi1lbmRwb2ludHMjc2V0LW5vdGlmaWNhdGlvbi1tZXRhZGF0YVxuICovXG5leHBvcnQgY29uc3Qgc2V0Tm90aWZpY2F0aW9uTWV0YWRhdGEgPSBhc3luYyAoXG4gIHBhcmFtczogUGFydGlhbFdpdGhSZXF1aXJlZEZpZWxkczxcbiAgICBTZXROb3RpZmljYXRpb25NZXRhZGF0YVJlcXVlc3QsXG4gICAgfCAnUHVibGljS2V5QmFzZTU4Q2hlY2snXG4gICAgfCAnTGFzdFNlZW5JbmRleCdcbiAgICB8ICdMYXN0VW5yZWFkTm90aWZpY2F0aW9uSW5kZXgnXG4gICAgfCAnVW5yZWFkTm90aWZpY2F0aW9ucydcbiAgPixcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pID0+IHtcbiAgcmV0dXJuIGp3dFBvc3QoJ2FwaS92MC9zZXQtbm90aWZpY2F0aW9uLW1ldGFkYXRhJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIEFkbWluIGVuZHBvaW50c1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLyoqXG4gKiBodHRwczovL2RvY3MuZGVzby5vcmcvZGVzby1iYWNrZW5kL2FwaS9hZG1pbi1lbmRwb2ludHMjZ2V0LXZlcmlmaWVkLXVzZXJzXG4gKi9cbmV4cG9ydCBjb25zdCBhZG1pbkdldFZlcmlmaWVkVXNlcnMgPSAoXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxBZG1pbkdldFZlcmlmaWVkVXNlcnNSZXNwb25zZT4gPT4ge1xuICByZXR1cm4gand0UG9zdCgnYXBpL3YwL2FkbWluL2dldC12ZXJpZmllZC11c2VycycsIHt9LCBvcHRpb25zKTtcbn07XG5cbi8qKlxuICogaHR0cHM6Ly9kb2NzLmRlc28ub3JnL2Rlc28tYmFja2VuZC9hcGkvYWRtaW4tZW5kcG9pbnRzI2dldC11c2VybmFtZS12ZXJpZmljYXRpb24tYXVkaXQtbG9nc1xuICovXG5leHBvcnQgY29uc3QgYWRtaW5HZXRVc2VybmFtZVZlcmlmaWNhdGlvbkF1ZGl0TG9nID0gKFxuICBwYXJhbXM6IEFkbWluR2V0VXNlcm5hbWVWZXJpZmljYXRpb25BdWRpdExvZ3NSZXF1ZXN0LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8QWRtaW5HZXRVc2VybmFtZVZlcmlmaWNhdGlvbkF1ZGl0TG9nc1Jlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KFxuICAgICdhcGkvdjAvYWRtaW4vZ2V0LXVzZXJuYW1lLXZlcmlmaWNhdGlvbi1hdWRpdC1sb2cnLFxuICAgIHBhcmFtcyxcbiAgICBvcHRpb25zXG4gICk7XG59O1xuXG5leHBvcnQgY29uc3QgYWRtaW5Ob2RlQ29udHJvbCA9IChcbiAgcGFyYW1zOiBQYXJ0aWFsV2l0aFJlcXVpcmVkRmllbGRzPFxuICAgIE9taXQ8Tm9kZUNvbnRyb2xSZXF1ZXN0LCAnSldUJyB8ICdBZG1pblB1YmxpY0tleSc+LFxuICAgICdBZGRyZXNzJyB8ICdPcGVyYXRpb25UeXBlJ1xuICA+LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8Tm9kZUNvbnRyb2xSZXNwb25zZT4gPT4ge1xuICByZXR1cm4gand0UG9zdCgnYXBpL3YwL2FkbWluL25vZGUtY29udHJvbCcsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG5leHBvcnQgY29uc3QgYWRtaW5HcmFudFZlcmlmaWNhdGlvbkJhZGdlID0gKFxuICBwYXJhbXM6IE9taXQ8QWRtaW5HcmFudFZlcmlmaWNhdGlvbkJhZGdlUmVxdWVzdCwgJ0FkbWluUHVibGljS2V5Jz4sXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxBZG1pbkdyYW50VmVyaWZpY2F0aW9uQmFkZ2VSZXNwb25zZT4gPT4ge1xuICByZXR1cm4gand0UG9zdCgnYXBpL3YwL2FkbWluL2dyYW50LXZlcmlmaWNhdGlvbi1iYWRnZScsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG5leHBvcnQgY29uc3QgYWRtaW5SZW1vdmVWZXJpZmljYXRpb25CYWRnZSA9IChcbiAgcGFyYW1zOiBPbWl0PEFkbWluUmVtb3ZlVmVyaWZpY2F0aW9uQmFkZ2VSZXF1ZXN0LCAnQWRtaW5QdWJsaWNLZXknPixcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEFkbWluUmVtb3ZlVmVyaWZpY2F0aW9uQmFkZ2VSZXNwb25zZT4gPT4ge1xuICByZXR1cm4gand0UG9zdCgnYXBpL3YwL2FkbWluL3JlbW92ZS12ZXJpZmljYXRpb24tYmFkZ2UnLCBwYXJhbXMsIG9wdGlvbnMpO1xufTtcblxuZXhwb3J0IGNvbnN0IGFkbWluR2V0VXNlckFkbWluRGF0YSA9IChcbiAgcGFyYW1zOiBBZG1pbkdldFVzZXJBZG1pbkRhdGFSZXF1ZXN0LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8QWRtaW5HZXRVc2VyQWRtaW5EYXRhUmVzcG9uc2U+ID0+IHtcbiAgcmV0dXJuIGp3dFBvc3QoJ2FwaS92MC9hZG1pbi9nZXQtdXNlci1hZG1pbi1kYXRhJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pbkdldFVzZXJHbG9iYWxNZXRhZGF0YSA9IChcbiAgcGFyYW1zOiBBZG1pbkdldFVzZXJHbG9iYWxNZXRhZGF0YVJlcXVlc3QsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxBZG1pbkdldFVzZXJHbG9iYWxNZXRhZGF0YVJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYWRtaW4vZ2V0LXVzZXItZ2xvYmFsLW1ldGFkYXRhJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pblVwZGF0ZVVzZXJHbG9iYWxNZXRhZGF0YSA9IChcbiAgcGFyYW1zOiBPbWl0PEFkbWluVXBkYXRlVXNlckdsb2JhbE1ldGFkYXRhUmVxdWVzdCwgJ0FkbWluUHVibGljS2V5Jz4sXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYWRtaW4vdXBkYXRlLXVzZXItZ2xvYmFsLW1ldGFkYXRhJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pbkdldEFsbFVzZXJHbG9iYWxNZXRhZGF0YSA9IChcbiAgcGFyYW1zOiBBZG1pbkdldEFsbFVzZXJHbG9iYWxNZXRhZGF0YVJlcXVlc3QsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxBZG1pbkdldFVzZXJHbG9iYWxNZXRhZGF0YVJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYWRtaW4vZ2V0LWFsbC11c2VyLWdsb2JhbC1tZXRhZGF0YScsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG5leHBvcnQgY29uc3QgYWRtaW5QaW5Qb3N0ID0gKFxuICBwYXJhbXM6IEFkbWluUGluUG9zdFJlcXVlc3QsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYWRtaW4vcGluLXBvc3QnLCBwYXJhbXMsIG9wdGlvbnMpO1xufTtcblxuZXhwb3J0IGNvbnN0IGFkbWluVXBkYXRlR2xvYmFsRmVlZCA9IChcbiAgcGFyYW1zOiBBZG1pblVwZGF0ZUdsb2JhbEZlZWRSZXF1ZXN0LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8dm9pZD4gPT4ge1xuICByZXR1cm4gand0UG9zdCgnYXBpL3YwL2FkbWluL3VwZGF0ZS1nbG9iYWwtZmVlZCcsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG5leHBvcnQgY29uc3QgYWRtaW5SZW1vdmVOaWxQb3N0cyA9IChcbiAgcGFyYW1zOiBBZG1pblJlbW92ZU5pbFBvc3RzUmVxdWVzdCxcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgcmV0dXJuIGp3dFBvc3QoJ2FwaS92MC9hZG1pbi9yZW1vdmUtbmlsLXBvc3RzJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pblJlcHJvY2Vzc0JpdGNvaW5CbG9jayA9IChcbiAgYmxvY2tIYXNoT3JCbG9ja0hlaWdodDogc3RyaW5nLFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbikgPT4ge1xuICByZXR1cm4gand0UG9zdChcbiAgICBgYXBpL3YwL2FkbWluL3JlcHJvY2Vzcy1iaXRjb2luLWJsb2NrLyR7YmxvY2tIYXNoT3JCbG9ja0hlaWdodH1gLFxuICAgIHt9LFxuICAgIG9wdGlvbnNcbiAgKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pbkdldE1lbXBvb2xTdGF0cyA9IChcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEFkbWluR2V0TWVtcG9vbFN0YXRzUmVzcG9uc2U+ID0+IHtcbiAgcmV0dXJuIGp3dFBvc3QoJ2FwaS92MC9hZG1pbi9nZXQtbWVtcG9vbC1zdGF0cycsIHt9LCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pblN3YXBJZGVudGl0eSA9IGFzeW5jIChcbiAgcGFyYW1zOiBUeFJlcXVlc3RXaXRoT3B0aW9uYWxGZWVzQW5kRXh0cmFEYXRhPFN3YXBJZGVudGl0eVJlcXVlc3Q+LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8Q29uc3RydWN0ZWRBbmRTdWJtaXR0ZWRUeDxTd2FwSWRlbnRpdHlSZXNwb25zZT4+ID0+IHtcbiAgcmV0dXJuIGp3dFBvc3QoJ2FwaS92MC9hZG1pbi9zd2FwLWlkZW50aXR5JywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pblNldFVTRENlbnRzVG9ERVNPUmVzZXJ2ZUV4Y2hhbmdlUmF0ZSA9IChcbiAgcGFyYW1zOiBPbWl0PFNldFVTRENlbnRzVG9EZVNvRXhjaGFuZ2VSYXRlUmVxdWVzdCwgJ0FkbWluUHVibGljS2V5Jz4sXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxTZXRVU0RDZW50c1RvRGVTb0V4Y2hhbmdlUmF0ZVJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KFxuICAgICdhcGkvdjAvYWRtaW4vc2V0LXVzZC1jZW50cy10by1kZXNvLXJlc2VydmUtZXhjaGFuZ2UtcmF0ZScsXG4gICAgcGFyYW1zLFxuICAgIG9wdGlvbnNcbiAgKTtcbn07XG5cbi8vIE5vdCBhIGp3dCByZXF1ZXN0LCBidXQgaXQncyBhbiBhZG1pbiBlbmRwb2ludCBzbyBpdCdzIGhlcmUuLi5cbmV4cG9ydCBjb25zdCBhZG1pbkdldFVTRENlbnRzVG9ERVNPUmVzZXJ2ZUV4Y2hhbmdlUmF0ZSA9IChcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEdldFVTRENlbnRzVG9EZVNvRXhjaGFuZ2VSYXRlUmVzcG9uc2U+ID0+IHtcbiAgY29uc3QgZW5kcG9pbnQgPSAnYXBpL3YwL2FkbWluL2dldC11c2QtY2VudHMtdG8tZGVzby1yZXNlcnZlLWV4Y2hhbmdlLXJhdGUnO1xuICByZXR1cm4gYXBpLmdldChcbiAgICBvcHRpb25zPy5ub2RlVVJJID8gY2xlYW5VUkwob3B0aW9ucy5ub2RlVVJJLCBlbmRwb2ludCkgOiBlbmRwb2ludFxuICApO1xufTtcblxuZXhwb3J0IGNvbnN0IGFkbWluU2V0QnV5RGVzb0ZlZUJhc2lzUG9pbnRzID0gKFxuICBwYXJhbXM6IE9taXQ8U2V0QnV5RGVTb0ZlZUJhc2lzUG9pbnRzUmVxdWVzdCwgJ0FkbWluUHVibGljS2V5Jz4sXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxTZXRCdXlEZVNvRmVlQmFzaXNQb2ludHNSZXNwb25zZT4gPT4ge1xuICByZXR1cm4gand0UG9zdCgnYXBpL3YwL2FkbWluL3NldC1idXktZGVzby1mZWUtYmFzaXMtcG9pbnRzJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pbkdldEJ1eURlc29GZWVCYXNpc1BvaW50cyA9IChcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEdldEJ1eURlU29GZWVCYXNpc1BvaW50c1Jlc3BvbnNlPiA9PiB7XG4gIGNvbnN0IGVuZHBvaW50ID0gJ2FwaS92MC9hZG1pbi9nZXQtYnV5LWRlc28tZmVlLWJhc2lzLXBvaW50cyc7XG4gIHJldHVybiBhcGkuZ2V0KFxuICAgIG9wdGlvbnM/Lm5vZGVVUkkgPyBjbGVhblVSTChvcHRpb25zLm5vZGVVUkksIGVuZHBvaW50KSA6IGVuZHBvaW50XG4gICk7XG59O1xuXG5leHBvcnQgdHlwZSBBZG1pblVwZGF0ZUdsb2JhbFBhcmFtc1JlcXVlc3RQYXJhbXMgPVxuICBUeFJlcXVlc3RXaXRoT3B0aW9uYWxGZWVzQW5kRXh0cmFEYXRhPFxuICAgIFBhcnRpYWxXaXRoUmVxdWlyZWRGaWVsZHM8XG4gICAgICBVcGRhdGVHbG9iYWxQYXJhbXNSZXF1ZXN0LFxuICAgICAgfCAnVXBkYXRlclB1YmxpY0tleUJhc2U1OENoZWNrJ1xuICAgICAgfCAnVVNEQ2VudHNQZXJCaXRjb2luJ1xuICAgICAgfCAnQ3JlYXRlUHJvZmlsZUZlZU5hbm9zJ1xuICAgICAgfCAnTWF4Q29waWVzUGVyTkZUJ1xuICAgICAgfCAnQ3JlYXRlTkZURmVlTmFub3MnXG4gICAgICB8ICdNaW5pbXVtTmV0d29ya0ZlZU5hbm9zUGVyS0InXG4gICAgPlxuICA+O1xuXG5leHBvcnQgY29uc3QgYWRtaW5VcGRhdGVHbG9iYWxQYXJhbXMgPSBhc3luYyAoXG4gIHBhcmFtczogQWRtaW5VcGRhdGVHbG9iYWxQYXJhbXNSZXF1ZXN0UGFyYW1zLFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8Q29uc3RydWN0ZWRBbmRTdWJtaXR0ZWRUeDxVcGRhdGVHbG9iYWxQYXJhbXNSZXNwb25zZT4+ID0+IHtcbiAgcmV0dXJuIGhhbmRsZVNpZ25BbmRTdWJtaXQoJ2FwaS92MC9hZG1pbi91cGRhdGUtZ2xvYmFsLXBhcmFtcycsIHBhcmFtcywge1xuICAgIC4uLm9wdGlvbnMsXG4gICAgY29uc3RydWN0aW9uRnVuY3Rpb246IGNvbnN0cnVjdEFkbWluVXBkYXRlR2xvYmFsUGFyYW1zVHJhbnNhY3Rpb24sXG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGNvbnN0cnVjdEFkbWluVXBkYXRlR2xvYmFsUGFyYW1zVHJhbnNhY3Rpb24gPSBhc3luYyAoXG4gIHBhcmFtczogQWRtaW5VcGRhdGVHbG9iYWxQYXJhbXNSZXF1ZXN0UGFyYW1zXG4pOiBQcm9taXNlPENvbnN0cnVjdGVkVHJhbnNhY3Rpb25SZXNwb25zZT4gPT4ge1xuICBjb25zdCBtZXRhZGF0YSA9IG5ldyBUcmFuc2FjdGlvbk1ldGFkYXRhVXBkYXRlR2xvYmFsUGFyYW1zKCk7XG4gIGNvbnN0IGNvbnNlbnN1c0V4dHJhRGF0YUtWczogVHJhbnNhY3Rpb25FeHRyYURhdGFLVltdID0gW107XG4gIGlmIChwYXJhbXMuVVNEQ2VudHNQZXJCaXRjb2luID49IDApIHtcbiAgICBjb25zZW5zdXNFeHRyYURhdGFLVnMucHVzaChcbiAgICAgIG5ldyBUcmFuc2FjdGlvbkV4dHJhRGF0YUtWKFxuICAgICAgICBlbmNvZGVVVEY4VG9CeXRlcygnVVNEQ2VudHNQZXJCaXRjb2luJyksXG4gICAgICAgIHV2YXJpbnQ2NFRvQnVmKHBhcmFtcy5VU0RDZW50c1BlckJpdGNvaW4pXG4gICAgICApXG4gICAgKTtcbiAgfVxuICBpZiAocGFyYW1zLk1pbmltdW1OZXR3b3JrRmVlTmFub3NQZXJLQiA+PSAwKSB7XG4gICAgY29uc2Vuc3VzRXh0cmFEYXRhS1ZzLnB1c2goXG4gICAgICBuZXcgVHJhbnNhY3Rpb25FeHRyYURhdGFLVihcbiAgICAgICAgZW5jb2RlVVRGOFRvQnl0ZXMoJ01pbk5ldHdvcmtGZWVOYW5vc1BlcktCJyksXG4gICAgICAgIHV2YXJpbnQ2NFRvQnVmKHBhcmFtcy5NaW5pbXVtTmV0d29ya0ZlZU5hbm9zUGVyS0IpXG4gICAgICApXG4gICAgKTtcbiAgfVxuICBpZiAocGFyYW1zLkNyZWF0ZVByb2ZpbGVGZWVOYW5vcyA+PSAwKSB7XG4gICAgY29uc2Vuc3VzRXh0cmFEYXRhS1ZzLnB1c2goXG4gICAgICBuZXcgVHJhbnNhY3Rpb25FeHRyYURhdGFLVihcbiAgICAgICAgZW5jb2RlVVRGOFRvQnl0ZXMoJ0NyZWF0ZVByb2ZpbGVGZWVOYW5vcycpLFxuICAgICAgICB1dmFyaW50NjRUb0J1ZihwYXJhbXMuQ3JlYXRlUHJvZmlsZUZlZU5hbm9zKVxuICAgICAgKVxuICAgICk7XG4gIH1cbiAgaWYgKHBhcmFtcy5DcmVhdGVORlRGZWVOYW5vcyA+PSAwKSB7XG4gICAgY29uc2Vuc3VzRXh0cmFEYXRhS1ZzLnB1c2goXG4gICAgICBuZXcgVHJhbnNhY3Rpb25FeHRyYURhdGFLVihcbiAgICAgICAgZW5jb2RlVVRGOFRvQnl0ZXMoJ0NyZWF0ZU5GVEZlZU5hbm9zJyksXG4gICAgICAgIHV2YXJpbnQ2NFRvQnVmKHBhcmFtcy5DcmVhdGVORlRGZWVOYW5vcylcbiAgICAgIClcbiAgICApO1xuICB9XG4gIGlmIChwYXJhbXMuTWF4Q29waWVzUGVyTkZUID49IDApIHtcbiAgICBjb25zZW5zdXNFeHRyYURhdGFLVnMucHVzaChcbiAgICAgIG5ldyBUcmFuc2FjdGlvbkV4dHJhRGF0YUtWKFxuICAgICAgICBlbmNvZGVVVEY4VG9CeXRlcygnTWF4Q29waWVzUGVyTkZUJyksXG4gICAgICAgIHV2YXJpbnQ2NFRvQnVmKHBhcmFtcy5NYXhDb3BpZXNQZXJORlQpXG4gICAgICApXG4gICAgKTtcbiAgfVxuICByZXR1cm4gY29uc3RydWN0QmFsYW5jZU1vZGVsVHgocGFyYW1zLlVwZGF0ZXJQdWJsaWNLZXlCYXNlNThDaGVjaywgbWV0YWRhdGEsIHtcbiAgICBFeHRyYURhdGE6IHBhcmFtcy5FeHRyYURhdGEsXG4gICAgTWluRmVlUmF0ZU5hbm9zUGVyS0I6IHBhcmFtcy5NaW5GZWVSYXRlTmFub3NQZXJLQixcbiAgICBUcmFuc2FjdGlvbkZlZXM6IHBhcmFtcy5UcmFuc2FjdGlvbkZlZXMsXG4gICAgQ29uc2Vuc3VzRXh0cmFEYXRhS1ZzOiBjb25zZW5zdXNFeHRyYURhdGFLVnMsXG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGFkbWluR2V0R2xvYmFsUGFyYW1zID0gKFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8R2V0R2xvYmFsUGFyYW1zUmVzcG9uc2U+ID0+IHtcbiAgcmV0dXJuIGp3dFBvc3QoJ2FwaS92MC9hZG1pbi9nZXQtZ2xvYmFsLXBhcmFtcycsIHt9LCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pbkdldE5GVERyb3AgPSAoXG4gIHBhcmFtczogQWRtaW5HZXRORlREcm9wUmVxdWVzdCxcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEFkbWluR2V0TkZURHJvcFJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYWRtaW4vZ2V0LW5mdC1kcm9wJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pblVwZGF0ZU5GVERyb3AgPSAoXG4gIHBhcmFtczogQWRtaW5VcGRhdGVORlREcm9wUmVxdWVzdCxcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEFkbWluVXBkYXRlTkZURHJvcFJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCcvYXBpL3YwL2FkbWluL3VwZGF0ZS1uZnQtZHJvcCcsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG5leHBvcnQgY29uc3QgYWRtaW5HZXRVbmZpbHRlcmVkSG90RmVlZCA9IChcbiAgcGFyYW1zOiBQYXJ0aWFsPEhvdEZlZWRQYWdlUmVxdWVzdD4sXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxIb3RGZWVkUGFnZVJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYWRtaW4vZ2V0LXVuZmlsdGVyZWQtaG90LWZlZWQnLCBwYXJhbXMsIG9wdGlvbnMpO1xufTtcblxuZXhwb3J0IGNvbnN0IGFkbWluR2V0SG90RmVlZEFsZ29yaXRobSA9IChcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEFkbWluR2V0SG90RmVlZEFsZ29yaXRobVJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYWRtaW4vZ2V0LWhvdC1mZWVkLWFsZ29yaXRobScsIHt9LCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pblVwZGF0ZUhvdEZlZWRBbGdvcml0aG0gPSAoXG4gIHBhcmFtczogQWRtaW5VcGRhdGVIb3RGZWVkQWxnb3JpdGhtUmVxdWVzdCxcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgcmV0dXJuIGp3dFBvc3QoJ2FwaS92MC9hZG1pbi91cGRhdGUtaG90LWZlZWQtYWxnb3JpdGhtJywgcGFyYW1zLCBvcHRpb25zKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pblVwZGF0ZUhvdEZlZWRVc2VyTXVsdGlwbGllciA9IChcbiAgcGFyYW1zOiBBZG1pblVwZGF0ZUhvdEZlZWRVc2VyTXVsdGlwbGllclJlcXVlc3QsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KFxuICAgICdhcGkvdjAvYWRtaW4vdXBkYXRlLWhvdC1mZWVkLXVzZXItbXVsdGlwbGllcicsXG4gICAgcGFyYW1zLFxuICAgIG9wdGlvbnNcbiAgKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pblVwZGF0ZUhvdEZlZWRQb3N0TXVsdGlwbGllciA9IChcbiAgcGFyYW1zOiBBZG1pblVwZGF0ZUhvdEZlZWRQb3N0TXVsdGlwbGllclJlcXVlc3QsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KFxuICAgICdhcGkvdjAvYWRtaW4vdXBkYXRlLWhvdC1mZWVkLXBvc3QtbXVsdGlwbGllcicsXG4gICAgcGFyYW1zLFxuICAgIG9wdGlvbnNcbiAgKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pbkdldEhvdEZlZWRVc2VyTXVsdGlwbGllciA9IChcbiAgcGFyYW1zOiBBZG1pbkdldEhvdEZlZWRVc2VyTXVsdGlwbGllclJlcXVlc3QsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxBZG1pbkdldEhvdEZlZWRVc2VyTXVsdGlwbGllclJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvYWRtaW4vZ2V0LWhvdC1mZWVkLXVzZXItbXVsdGlwbGllcicsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG5leHBvcnQgY29uc3QgYWRtaW5HZXRXeXJlV2FsbGV0T3JkZXJzRm9yVXNlciA9IChcbiAgcGFyYW1zOlxuICAgIHwgUGFydGlhbFdpdGhSZXF1aXJlZEZpZWxkczxcbiAgICAgICAgT21pdDxHZXRXeXJlV2FsbGV0T3JkZXJGb3JQdWJsaWNLZXlSZXF1ZXN0LCAnQWRtaW5QdWJsaWNLZXknPixcbiAgICAgICAgJ1B1YmxpY0tleUJhc2U1OENoZWNrJ1xuICAgICAgPlxuICAgIHwgUGFydGlhbFdpdGhSZXF1aXJlZEZpZWxkczxcbiAgICAgICAgT21pdDxHZXRXeXJlV2FsbGV0T3JkZXJGb3JQdWJsaWNLZXlSZXF1ZXN0LCAnQWRtaW5QdWJsaWNLZXknPixcbiAgICAgICAgJ1VzZXJuYW1lJ1xuICAgICAgPixcbiAgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zXG4pOiBQcm9taXNlPEdldFd5cmVXYWxsZXRPcmRlckZvclB1YmxpY0tleVJlc3BvbnNlPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KFxuICAgICdhcGkvdjAvYWRtaW4vZ2V0LXd5cmUtd2FsbGV0LW9yZGVycy1mb3ItcHVibGljLWtleScsXG4gICAgcGFyYW1zLFxuICAgIG9wdGlvbnNcbiAgKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pbkdldFd5cmVXYWxsZXRPcmRlclF1b3RhdGlvbiA9IChcbiAgcGFyYW1zOiBXYWxsZXRPcmRlclF1b3RhdGlvblJlcXVlc3QsXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxXeXJlV2FsbGV0T3JkZXJRdW90YXRpb25QYXlsb2FkPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KFxuICAgICdhcGkvdjAvYWRtaW4vZ2V0LXd5cmUtd2FsbGV0LW9yZGVyLXF1b3RhdGlvbicsXG4gICAgcGFyYW1zLFxuICAgIG9wdGlvbnNcbiAgKTtcbn07XG5cbmV4cG9ydCBjb25zdCBhZG1pbkdldFd5cmVXYWxsZXRPcmRlclJlc2VydmF0aW9uID0gKFxuICBwYXJhbXM6IFdhbGxldE9yZGVyUmVzZXJ2YXRpb25SZXF1ZXN0LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8V3lyZVdhbGxldE9yZGVyUmVzZXJ2YXRpb25QYXlsb2FkPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KFxuICAgICdhcGkvdjAvYWRtaW4vZ2V0LXd5cmUtd2FsbGV0LW9yZGVyLXJlc2VydmF0aW9uJyxcbiAgICBwYXJhbXMsXG4gICAgb3B0aW9uc1xuICApO1xufTtcblxuZXhwb3J0IGNvbnN0IHJlc2VuZFZlcmlmeUVtYWlsID0gKFxuICBwYXJhbXM6IFBhcnRpYWxXaXRoUmVxdWlyZWRGaWVsZHM8UmVzZW5kVmVyaWZ5RW1haWxSZXF1ZXN0LCAnUHVibGljS2V5Jz4sXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gIHJldHVybiBqd3RQb3N0KCdhcGkvdjAvcmVzZW5kLXZlcmlmeS1lbWFpbCcsIHBhcmFtcywgb3B0aW9ucyk7XG59O1xuXG5leHBvcnQgY29uc3QgdmVyaWZ5RW1haWwgPSAoXG4gIHBhcmFtczogVmVyaWZ5RW1haWxSZXF1ZXN0LFxuICBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnNcbik6IFByb21pc2U8dm9pZD4gPT4ge1xuICBjb25zdCBlbmRwb2ludCA9ICdhcGkvdjAvdmVyaWZ5LWVtYWlsJztcbiAgcmV0dXJuIGFwaS5wb3N0KFxuICAgIG9wdGlvbnM/Lm5vZGVVUkkgPyBjbGVhblVSTChvcHRpb25zLm5vZGVVUkksIGVuZHBvaW50KSA6IGVuZHBvaW50LFxuICAgIHBhcmFtc1xuICApO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwbG9hZEltYWdlID0gYXN5bmMgKFxuICBwYXJhbXM6IFBhcnRpYWxXaXRoUmVxdWlyZWRGaWVsZHM8XG4gICAgVXBsb2FkSW1hZ2VSZXF1ZXN0LFxuICAgICdmaWxlJyB8ICdVc2VyUHVibGljS2V5QmFzZTU4Q2hlY2snXG4gID4sXG4gIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9uc1xuKTogUHJvbWlzZTxVcGxvYWRJbWFnZVJlc3BvbnNlPiA9PiB7XG4gIGNvbnN0IEpXVCA9IHBhcmFtcy5KV1QgPz8gKGF3YWl0IGlkZW50aXR5Lmp3dCgpKTtcbiAgY29uc3QgZW5kcG9pbnQgPSAnYXBpL3YwL3VwbG9hZC1pbWFnZSc7XG5cbiAgcmV0dXJuIGFwaS5wb3N0KFxuICAgIG9wdGlvbnM/Lm5vZGVVUkkgPyBjbGVhblVSTChvcHRpb25zLm5vZGVVUkksIGVuZHBvaW50KSA6IGVuZHBvaW50LFxuICAgIHsgSldULCAuLi5wYXJhbXMgfSxcbiAgICB7IGNvbnRlbnRUeXBlOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScgfVxuICApO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwbG9hZFZpZGVvID0gYXN5bmMgKFxuICBwYXJhbXM6IFBhcnRpYWxXaXRoUmVxdWlyZWRGaWVsZHM8XG4gICAgVXBsb2FkVmlkZW9SZXF1ZXN0LFxuICAgICdVc2VyUHVibGljS2V5QmFzZTU4Q2hlY2snIHwgJ2ZpbGUnXG4gID5cbik6IFByb21pc2U8VXBsb2FkVmlkZW9WMlJlc3BvbnNlPiA9PiB7XG4gIGNvbnN0IEpXVCA9IHBhcmFtcy5KV1QgPz8gKGF3YWl0IGlkZW50aXR5Lmp3dCgpKTtcbiAgY29uc3QgZW5kcG9pbnQgPSAnYXBpL3YwL3VwbG9hZC12aWRlbyc7XG4gIHJldHVybiBtZWRpYS5wb3N0KFxuICAgIGVuZHBvaW50LFxuICAgIHsgSldULCAuLi5wYXJhbXMgfSxcbiAgICB7IGNvbnRlbnRUeXBlOiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScgfVxuICApO1xufTtcbiJdfQ==