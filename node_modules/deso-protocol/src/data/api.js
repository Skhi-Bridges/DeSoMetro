var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {
    if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
    if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
    return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var _APIClient_instances, _APIClient_url;
class DeSoAPIError {
    constructor(message, status) {
        Object.defineProperty(this, "message", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        Object.defineProperty(this, "status", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.message = message;
        this.status = status;
    }
    toString() {
        return this.message;
    }
}
const wrappedFetch = (url, options) => {
    return fetch(url, options).then((res) => {
        if (!res.ok) {
            return res.json().then((json) => {
                throw new DeSoAPIError(json.error, res.status);
            });
        }
        return res.text().then((rawBodyText) => {
            if (rawBodyText.length === 0) {
                // In the case where the response body is empty, it will fail to parse
                // as JSON so we just handle it as a special case.
                return null;
            }
            else {
                return JSON.parse(rawBodyText);
            }
        });
    });
};
export const cleanURL = (origin, endpoint) => {
    return `${origin.replace(/\/+$/, '')}/${endpoint.replace(/^\/+/, '')}`;
};
class APIClient {
    constructor() {
        _APIClient_instances.add(this);
        Object.defineProperty(this, "uri", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: ''
        });
    }
    post(endpoint, data, options = {}) {
        const contentType = options.contentType ?? 'application/json';
        let body;
        switch (contentType) {
            case 'multipart/form-data':
                body = new FormData();
                for (const key in data) {
                    body.append(key, data[key]);
                }
                break;
            case 'application/json':
                body = JSON.stringify(data);
                break;
            default:
                throw new Error(`Unsupported content type: ${contentType}`);
        }
        return wrappedFetch(__classPrivateFieldGet(this, _APIClient_instances, "m", _APIClient_url).call(this, endpoint), {
            method: 'POST',
            body,
            headers: {
                // NOTE: We only set the content type header if it's not
                // multipart/form-data.  This is because we need the browser to
                // automatically set the boundary for us when we use FormData:
                // https://stackoverflow.com/a/39281156
                ...(contentType !== 'multipart/form-data' && {
                    'Content-Type': contentType,
                }),
            },
            ...options,
        });
    }
    get(endpoint) {
        return wrappedFetch(__classPrivateFieldGet(this, _APIClient_instances, "m", _APIClient_url).call(this, endpoint), { method: 'GET' });
    }
}
_APIClient_instances = new WeakSet(), _APIClient_url = function _APIClient_url(endpoint) {
    if (endpoint.startsWith('http://') || endpoint.startsWith('https://')) {
        // If the endpoint is a full URL, just use it directly.
        // This is an optional case that allows us to override the node URI.
        return endpoint;
    }
    // Otherwise use the node URI and endpoint to construct a URL.
    // This will be the typical case.
    return cleanURL(this.uri, endpoint);
};
class DeSoNodeClient extends APIClient {
    constructor() {
        super(...arguments);
        Object.defineProperty(this, "uri", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 'https://node.deso.org'
        });
    }
    get nodeURI() {
        return this.uri;
    }
    configure(options) {
        if (typeof options.nodeURI === 'string') {
            this.uri = options.nodeURI;
        }
    }
}
class DeSoMediaClient extends APIClient {
    constructor() {
        super(...arguments);
        Object.defineProperty(this, "uri", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: 'https://media.deso.org'
        });
    }
    get mediaURI() {
        return this.uri;
    }
    configure(options) {
        if (typeof options.mediaURI === 'string') {
            this.uri = options.mediaURI;
        }
    }
}
export const media = new DeSoMediaClient();
export const api = new DeSoNodeClient();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBpLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2RhdGEvYXBpLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU0sWUFBWTtJQUloQixZQUFZLE9BQWUsRUFBRSxNQUFjO1FBSDNDOzs7OztXQUFnQjtRQUNoQjs7Ozs7V0FBZTtRQUdiLElBQUksQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0lBQ3ZCLENBQUM7SUFFRCxRQUFRO1FBQ04sT0FBTyxJQUFJLENBQUMsT0FBTyxDQUFDO0lBQ3RCLENBQUM7Q0FDRjtBQUVELE1BQU0sWUFBWSxHQUFHLENBQUMsR0FBVyxFQUFFLE9BQVksRUFBRSxFQUFFO0lBQ2pELE9BQU8sS0FBSyxDQUFDLEdBQUcsRUFBRSxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtRQUN0QyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRTtZQUNYLE9BQU8sR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFO2dCQUM5QixNQUFNLElBQUksWUFBWSxDQUFDLElBQUksQ0FBQyxLQUFLLEVBQUUsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1lBQ2pELENBQUMsQ0FBQyxDQUFDO1NBQ0o7UUFDRCxPQUFPLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsRUFBRTtZQUNyQyxJQUFJLFdBQVcsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO2dCQUM1QixzRUFBc0U7Z0JBQ3RFLGtEQUFrRDtnQkFDbEQsT0FBTyxJQUFJLENBQUM7YUFDYjtpQkFBTTtnQkFDTCxPQUFPLElBQUksQ0FBQyxLQUFLLENBQUMsV0FBVyxDQUFDLENBQUM7YUFDaEM7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FB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LE9BQThCO1FBQ3RDLElBQUksT0FBTyxPQUFPLENBQUMsUUFBUSxLQUFLLFFBQVEsRUFBRTtZQUN4QyxJQUFJLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUM7U0FDN0I7SUFDSCxDQUFDO0NBQ0Y7QUFFRCxNQUFNLENBQUMsTUFBTSxLQUFLLEdBQUcsSUFBSSxlQUFlLEVBQUUsQ0FBQztBQUMzQyxNQUFNLENBQUMsTUFBTSxHQUFHLEdBQUcsSUFBSSxjQUFjLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIERlU29BUElFcnJvciB7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgc3RhdHVzOiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IobWVzc2FnZTogc3RyaW5nLCBzdGF0dXM6IG51bWJlcikge1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gIH1cblxuICB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5tZXNzYWdlO1xuICB9XG59XG5cbmNvbnN0IHdyYXBwZWRGZXRjaCA9ICh1cmw6IHN0cmluZywgb3B0aW9uczogYW55KSA9PiB7XG4gIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oKHJlcykgPT4ge1xuICAgIGlmICghcmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKS50aGVuKChqc29uKSA9PiB7XG4gICAgICAgIHRocm93IG5ldyBEZVNvQVBJRXJyb3IoanNvbi5lcnJvciwgcmVzLnN0YXR1cyk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcy50ZXh0KCkudGhlbigocmF3Qm9keVRleHQpID0+IHtcbiAgICAgIGlmIChyYXdCb2R5VGV4dC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgLy8gSW4gdGhlIGNhc2Ugd2hlcmUgdGhlIHJlc3BvbnNlIGJvZHkgaXMgZW1wdHksIGl0IHdpbGwgZmFpbCB0byBwYXJzZVxuICAgICAgICAvLyBhcyBKU09OIHNvIHdlIGp1c3QgaGFuZGxlIGl0IGFzIGEgc3BlY2lhbCBjYXNlLlxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHJhd0JvZHlUZXh0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIERlc29Ob2RlQ2xpZW50Q29uZmlnIHtcbiAgbm9kZVVSST86IHN0cmluZztcbiAgbWVkaWFVUkk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGVzb01lZGlhQ2xpZW50Q29uZmlnIHtcbiAgbWVkaWFVUkk/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBjbGVhblVSTCA9IChvcmlnaW46IHN0cmluZywgZW5kcG9pbnQ6IHN0cmluZykgPT4ge1xuICByZXR1cm4gYCR7b3JpZ2luLnJlcGxhY2UoL1xcLyskLywgJycpfS8ke2VuZHBvaW50LnJlcGxhY2UoL15cXC8rLywgJycpfWA7XG59O1xuXG5jbGFzcyBBUElDbGllbnQge1xuICBwcm90ZWN0ZWQgdXJpID0gJyc7XG5cbiAgcG9zdChcbiAgICBlbmRwb2ludDogc3RyaW5nLFxuICAgIGRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4sXG4gICAgb3B0aW9uczogeyBjb250ZW50VHlwZT86ICdtdWx0aXBhcnQvZm9ybS1kYXRhJyB9ID0ge31cbiAgKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBjb250ZW50VHlwZSA9IG9wdGlvbnMuY29udGVudFR5cGUgPz8gJ2FwcGxpY2F0aW9uL2pzb24nO1xuICAgIGxldCBib2R5OiBGb3JtRGF0YSB8IHN0cmluZztcblxuICAgIHN3aXRjaCAoY29udGVudFR5cGUpIHtcbiAgICAgIGNhc2UgJ211bHRpcGFydC9mb3JtLWRhdGEnOlxuICAgICAgICBib2R5ID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcbiAgICAgICAgICBib2R5LmFwcGVuZChrZXksIGRhdGFba2V5XSk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdhcHBsaWNhdGlvbi9qc29uJzpcbiAgICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5zdXBwb3J0ZWQgY29udGVudCB0eXBlOiAke2NvbnRlbnRUeXBlfWApO1xuICAgIH1cblxuICAgIHJldHVybiB3cmFwcGVkRmV0Y2godGhpcy4jdXJsKGVuZHBvaW50KSwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBib2R5LFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAvLyBOT1RFOiBXZSBvbmx5IHNldCB0aGUgY29udGVudCB0eXBlIGhlYWRlciBpZiBpdCdzIG5vdFxuICAgICAgICAvLyBtdWx0aXBhcnQvZm9ybS1kYXRhLiAgVGhpcyBpcyBiZWNhdXNlIHdlIG5lZWQgdGhlIGJyb3dzZXIgdG9cbiAgICAgICAgLy8gYXV0b21hdGljYWxseSBzZXQgdGhlIGJvdW5kYXJ5IGZvciB1cyB3aGVuIHdlIHVzZSBGb3JtRGF0YTpcbiAgICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM5MjgxMTU2XG4gICAgICAgIC4uLihjb250ZW50VHlwZSAhPT0gJ211bHRpcGFydC9mb3JtLWRhdGEnICYmIHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogY29udGVudFR5cGUsXG4gICAgICAgIH0pLFxuICAgICAgfSxcbiAgICAgIC4uLm9wdGlvbnMsXG4gICAgfSk7XG4gIH1cblxuICBnZXQoZW5kcG9pbnQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIHdyYXBwZWRGZXRjaCh0aGlzLiN1cmwoZW5kcG9pbnQpLCB7IG1ldGhvZDogJ0dFVCcgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyBhIFVSTCBmb3IgdGhlIGdpdmVuIG5vZGUgVVJJIGFuZCBlbmRwb2ludCBhZnRlciBub3JtYWxpemluZyBhbnlcbiAgICogdHJhaWxpbmcgb3IgbGVhZGluZyBzbGFzaGVzLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgI3VybChlbmRwb2ludDogc3RyaW5nKSB7XG4gICAgaWYgKGVuZHBvaW50LnN0YXJ0c1dpdGgoJ2h0dHA6Ly8nKSB8fCBlbmRwb2ludC5zdGFydHNXaXRoKCdodHRwczovLycpKSB7XG4gICAgICAvLyBJZiB0aGUgZW5kcG9pbnQgaXMgYSBmdWxsIFVSTCwganVzdCB1c2UgaXQgZGlyZWN0bHkuXG4gICAgICAvLyBUaGlzIGlzIGFuIG9wdGlvbmFsIGNhc2UgdGhhdCBhbGxvd3MgdXMgdG8gb3ZlcnJpZGUgdGhlIG5vZGUgVVJJLlxuICAgICAgcmV0dXJuIGVuZHBvaW50O1xuICAgIH1cbiAgICAvLyBPdGhlcndpc2UgdXNlIHRoZSBub2RlIFVSSSBhbmQgZW5kcG9pbnQgdG8gY29uc3RydWN0IGEgVVJMLlxuICAgIC8vIFRoaXMgd2lsbCBiZSB0aGUgdHlwaWNhbCBjYXNlLlxuICAgIHJldHVybiBjbGVhblVSTCh0aGlzLnVyaSwgZW5kcG9pbnQpO1xuICB9XG59XG5cbmNsYXNzIERlU29Ob2RlQ2xpZW50IGV4dGVuZHMgQVBJQ2xpZW50IHtcbiAgb3ZlcnJpZGUgdXJpID0gJ2h0dHBzOi8vbm9kZS5kZXNvLm9yZyc7XG5cbiAgZ2V0IG5vZGVVUkkoKSB7XG4gICAgcmV0dXJuIHRoaXMudXJpO1xuICB9XG5cbiAgY29uZmlndXJlKG9wdGlvbnM6IERlc29Ob2RlQ2xpZW50Q29uZmlnKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLm5vZGVVUkkgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0aGlzLnVyaSA9IG9wdGlvbnMubm9kZVVSSTtcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgRGVTb01lZGlhQ2xpZW50IGV4dGVuZHMgQVBJQ2xpZW50IHtcbiAgb3ZlcnJpZGUgdXJpID0gJ2h0dHBzOi8vbWVkaWEuZGVzby5vcmcnO1xuXG4gIGdldCBtZWRpYVVSSSgpIHtcbiAgICByZXR1cm4gdGhpcy51cmk7XG4gIH1cblxuICBjb25maWd1cmUob3B0aW9uczogRGVzb01lZGlhQ2xpZW50Q29uZmlnKSB7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLm1lZGlhVVJJID09PSAnc3RyaW5nJykge1xuICAgICAgdGhpcy51cmkgPSBvcHRpb25zLm1lZGlhVVJJO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgbWVkaWEgPSBuZXcgRGVTb01lZGlhQ2xpZW50KCk7XG5leHBvcnQgY29uc3QgYXBpID0gbmV3IERlU29Ob2RlQ2xpZW50KCk7XG4iXX0=