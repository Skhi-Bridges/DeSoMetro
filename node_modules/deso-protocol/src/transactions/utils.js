import { identity, } from '../identity/index.js';
export async function guardTxPermission(spendingLimitOptions) {
    const hasPermissions = identity.hasPermissions(spendingLimitOptions);
    const guard = (hasPermissions) => {
        if (!hasPermissions) {
            return identity.requestPermissions({
                ...spendingLimitOptions,
                GlobalDESOLimit: (identity.transactionSpendingLimitOptions.GlobalDESOLimit ?? 0) +
                    (spendingLimitOptions.GlobalDESOLimit ?? 0),
            });
        }
    };
    if (typeof hasPermissions === 'boolean') {
        return guard(hasPermissions);
    }
    else {
        return hasPermissions.then(guard);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvdHJhbnNhY3Rpb25zL3V0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFFTCxRQUFRLEdBQ1QsTUFBTSxzQkFBc0IsQ0FBQztBQUU5QixNQUFNLENBQUMsS0FBSyxVQUFVLGlCQUFpQixDQUNyQyxvQkFBNkQ7SUFFN0QsTUFBTSxjQUFjLEdBQUcsUUFBUSxDQUFDLGNBQWMsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQ3JFLE1BQU0sS0FBSyxHQUFHLENBQUMsY0FBdUIsRUFBRSxFQUFFO1FBQ3hDLElBQUksQ0FBQyxjQUFjLEVBQUU7WUFDbkIsT0FBTyxRQUFRLENBQUMsa0JBQWtCLENBQUM7Z0JBQ2pDLEdBQUcsb0JBQW9CO2dCQUN2QixlQUFlLEVBQ2IsQ0FBQyxRQUFRLENBQUMsK0JBQStCLENBQUMsZUFBZSxJQUFJLENBQUMsQ0FBQztvQkFDL0QsQ0FBQyxvQkFBb0IsQ0FBQyxlQUFlLElBQUksQ0FBQyxDQUFDO2FBQzlDLENBQUMsQ0FBQztTQUNKO0lBQ0gsQ0FBQyxDQUFDO0lBRUYsSUFBSSxPQUFPLGNBQWMsS0FBSyxTQUFTLEVBQUU7UUFDdkMsT0FBTyxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUM7S0FDOUI7U0FBTTtRQUNMLE9BQVEsY0FBbUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDekQ7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgVHJhbnNhY3Rpb25TcGVuZGluZ0xpbWl0UmVzcG9uc2VPcHRpb25zLFxuICBpZGVudGl0eSxcbn0gZnJvbSAnLi4vaWRlbnRpdHkvaW5kZXguanMnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ3VhcmRUeFBlcm1pc3Npb24oXG4gIHNwZW5kaW5nTGltaXRPcHRpb25zOiBUcmFuc2FjdGlvblNwZW5kaW5nTGltaXRSZXNwb25zZU9wdGlvbnNcbikge1xuICBjb25zdCBoYXNQZXJtaXNzaW9ucyA9IGlkZW50aXR5Lmhhc1Blcm1pc3Npb25zKHNwZW5kaW5nTGltaXRPcHRpb25zKTtcbiAgY29uc3QgZ3VhcmQgPSAoaGFzUGVybWlzc2lvbnM6IGJvb2xlYW4pID0+IHtcbiAgICBpZiAoIWhhc1Blcm1pc3Npb25zKSB7XG4gICAgICByZXR1cm4gaWRlbnRpdHkucmVxdWVzdFBlcm1pc3Npb25zKHtcbiAgICAgICAgLi4uc3BlbmRpbmdMaW1pdE9wdGlvbnMsXG4gICAgICAgIEdsb2JhbERFU09MaW1pdDpcbiAgICAgICAgICAoaWRlbnRpdHkudHJhbnNhY3Rpb25TcGVuZGluZ0xpbWl0T3B0aW9ucy5HbG9iYWxERVNPTGltaXQgPz8gMCkgK1xuICAgICAgICAgIChzcGVuZGluZ0xpbWl0T3B0aW9ucy5HbG9iYWxERVNPTGltaXQgPz8gMCksXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKHR5cGVvZiBoYXNQZXJtaXNzaW9ucyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgcmV0dXJuIGd1YXJkKGhhc1Blcm1pc3Npb25zKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gKGhhc1Blcm1pc3Npb25zIGFzIFByb21pc2U8Ym9vbGVhbj4pLnRoZW4oZ3VhcmQpO1xuICB9XG59XG4iXX0=